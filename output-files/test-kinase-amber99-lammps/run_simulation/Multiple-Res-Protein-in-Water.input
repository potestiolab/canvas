units real
atom_style full

dimension 3
boundary p p p

bond_style       hybrid harmonic
angle_style      hybrid harmonic
dihedral_style   hybrid charmm multi/harmonic
special_bonds    lj 0.0 0.0 0.5 coul 0.0 0.0 0.8333

read_data        Multiple-Res-Protein-in-Water.lmp
#read_restart    restart.Mult-Res-T300.50000

######################################################################

variable         root index Mult-Res-T300
variable         Nrun equal 500000   #500 ps
variable         Nf equal 100
variable         Ne equal 100
variable         Nr equal ${Nf}/${Ne}
variable         Ndump equal 10000
variable         Nrestart equal 10000
variable         Text equal 300.0
variable         Pext equal 10.0

######################################################################

pair_style       lj/cut/coul/dsf 0.2 10.0 12.0
pair_modify      tail yes

pair_coeff 1 1   0.1700000   3.2500000
pair_coeff 2 2   0.0157000   1.0690800
pair_coeff 3 3   0.1094001   3.3996700
pair_coeff 4 4   0.0157000   1.9599800
pair_coeff 5 5   0.0157000   2.6495300
pair_coeff 6 6   0.0157000   2.4713500
pair_coeff 7 7   0.2500000   3.5635900
pair_coeff 8 8   0.0860000   3.3996700
pair_coeff 9 9   0.2100000   2.9599200
pair_coeff 10 10   0.1700000   3.2500000
pair_coeff 11 11   0.1700000   3.2500000
pair_coeff 12 12   0.0860000   3.3996700
pair_coeff 13 13   0.2104001   3.0664700
pair_coeff 14 14   0.0000000   0.0000000
pair_coeff 15 15   0.0150000   2.5996400
pair_coeff 16 16   0.2100000   2.9599200
pair_coeff 17 17   0.0516624   1.0191173
pair_coeff 18 18   0.0462165   2.9005362
pair_coeff 19 19   0.0860000   3.3996700
pair_coeff 20 20   0.2100000   2.9599200
pair_coeff 21 21   0.0516624   1.0101980
pair_coeff 22 22   0.0449741   3.1818249
pair_coeff 23 23   0.0367451   2.5781776
pair_coeff 24 24   0.0334302   4.1453428
pair_coeff 25 25   0.0516624   1.0146921
pair_coeff 26 26   0.0299874   1.5458044
pair_coeff 27 27   0.0860000   3.3996700
pair_coeff 28 28   0.2100000   2.9599200
pair_coeff 29 29   0.0516624   1.0041912
pair_coeff 30 30   0.0469788   4.8924752
pair_coeff 31 31   0.0860000   3.3996700
pair_coeff 32 32   0.2100000   2.9599200
pair_coeff 33 33   0.0516624   0.9992497
pair_coeff 34 34   0.0360775   2.8567828
pair_coeff 35 35   0.0367451   2.7759503
pair_coeff 36 36   0.2100000   2.9599200
pair_coeff 37 37   0.0516624   1.0049378
pair_coeff 38 38   0.0341308   3.5222947
pair_coeff 39 39   0.0860000   3.3996700
pair_coeff 40 40   0.2100000   2.9599200
pair_coeff 41 41   0.0516624   1.0053358
pair_coeff 42 42   0.0421407   4.1831295
pair_coeff 43 43   0.0860000   3.3996700
pair_coeff 44 44   0.0424691   5.2814725
pair_coeff 45 45   0.0516624   1.0167104
pair_coeff 46 46   0.0299874   2.4349880
pair_coeff 47 47   0.0860000   3.3996700
pair_coeff 48 48   0.0372733   4.4111464
pair_coeff 49 49   0.0516624   1.0053358
pair_coeff 50 50   0.0299874   2.4586582
pair_coeff 51 51   0.0860000   3.3996700
pair_coeff 52 52   0.2100000   2.9599200
pair_coeff 53 53   0.0347336   2.3738951
pair_coeff 54 54   0.0318045   3.5890559
pair_coeff 55 55   0.0860000   3.3996700
pair_coeff 56 56   0.0372683   3.6429902
pair_coeff 57 57   0.0516624   1.0139527
pair_coeff 58 58   0.0318045   4.3685919
pair_coeff 59 59   0.0860000   3.3996700
pair_coeff 60 60   0.2100000   2.9599200
pair_coeff 61 61   0.0516624   1.0082658
pair_coeff 62 62   0.0462165   2.8436625
pair_coeff 63 63   0.0860000   3.3996700
pair_coeff 64 64   0.0574195   2.8646989
pair_coeff 65 65   0.0516624   1.0155294
pair_coeff 66 66   0.0299874   1.5432433
pair_coeff 67 67   0.0860000   3.3996700
pair_coeff 68 68   0.0497238   3.5834682
pair_coeff 69 69   0.0516624   1.0073232
pair_coeff 70 70   0.0462165   2.9315539
pair_coeff 71 71   0.0860000   3.3996700
pair_coeff 72 72   0.0574195   2.3373917
pair_coeff 73 73   0.0544649   3.3763072
pair_coeff 74 74   0.0393894   4.2633537
pair_coeff 75 75   0.0860000   3.3996700
pair_coeff 76 76   0.2100000   2.9599200
pair_coeff 77 77   0.0347336   2.7550519
pair_coeff 78 78   0.0341308   3.5121145
pair_coeff 79 79   0.0860000   3.3996700
pair_coeff 80 80   0.0574195   3.1496666
pair_coeff 81 81   0.0347336   3.5280841
pair_coeff 82 82   0.0299874   1.5681553
pair_coeff 83 83   0.0860000   3.3996700
pair_coeff 84 84   0.2100000   2.9599200
pair_coeff 85 85   0.0516624   0.9977475
pair_coeff 86 86   0.0372065   3.4403015
pair_coeff 87 87   0.0860000   3.3996700
pair_coeff 88 88   0.2100000   2.9599200
pair_coeff 89 89   0.0516624   1.0082658
pair_coeff 90 90   0.0444940   4.1522668
pair_coeff 91 91   0.0367451   4.2738858
pair_coeff 92 92   0.0300248   4.1164092
pair_coeff 93 93   0.0347336   2.9902954
pair_coeff 94 94   0.0273395   3.3979682
pair_coeff 95 95   0.0860000   3.3996700
pair_coeff 96 96   0.2100000   2.9599200
pair_coeff 97 97   0.0516624   1.0112369
pair_coeff 98 98   0.0360775   2.9454967
pair_coeff 99 99   0.0523785   3.9478886
pair_coeff 100 100   0.0451671   3.8844152
pair_coeff 101 101   0.0708172   3.5055499
pair_coeff 102 102   0.0505962   4.1613327
pair_coeff 103 103   0.0432061   4.9656481
pair_coeff 104 104   0.0605787   3.6774110
pair_coeff 105 105   0.0451305   3.4528278
pair_coeff 106 106   0.0537718   3.0777808
pair_coeff 107 107   0.0323694   5.0804896
pair_coeff 108 108   0.0477688   3.7654334
pair_coeff 109 109   0.0331265   3.8503798
pair_coeff 110 110   0.0860000   3.3996700
pair_coeff 111 111   0.0574195   2.9206848
pair_coeff 112 112   0.0347336   2.2926355
pair_coeff 113 113   0.0341308   3.2830388
pair_coeff 114 114   0.0860000   3.3996700
pair_coeff 115 115   0.2100000   2.9599200
pair_coeff 116 116   0.0233520   4.1360811
pair_coeff 117 117   0.0449741   3.3070266
pair_coeff 118 118   0.0860000   3.3996700
pair_coeff 119 119   0.0574195   2.6090803
pair_coeff 120 120   0.0516624   1.0020978
pair_coeff 121 121   0.0603370   3.2123842
pair_coeff 122 122   0.0860000   3.3996700
pair_coeff 123 123   0.0372683   3.4727255
pair_coeff 124 124   0.0833233   2.6764249
pair_coeff 125 125   0.0325139   4.0234399
pair_coeff 126 126   0.0367451   2.9223792
pair_coeff 127 127   0.2100000   2.9599200
pair_coeff 128 128   0.0824497   2.4562664
pair_coeff 129 129   0.0414437   3.5002829
pair_coeff 130 130   0.0860000   3.3996700
pair_coeff 131 131   0.0388855   3.5667890
pair_coeff 132 132   0.0516624   1.0103960
pair_coeff 133 133   0.0318045   3.7866150
pair_coeff 134 134   0.0367451   2.5372032
pair_coeff 135 135   0.0487819   3.3452018
pair_coeff 136 136   0.0516624   1.0171037
pair_coeff 137 137   0.0379433   3.6697215
pair_coeff 138 138   0.0367451   2.6292204
pair_coeff 139 139   0.2100000   2.9599200
pair_coeff 140 140   0.0516624   1.0049876
pair_coeff 141 141   0.0299874   2.5618158
pair_coeff 142 142   0.0367451   3.0673278
pair_coeff 143 143   0.0487819   2.8574377
pair_coeff 144 144   0.0516624   1.0101980
pair_coeff 145 145   0.0318045   3.5955721
pair_coeff 146 146   0.1466288   4.0578443
pair_coeff 147 147   0.2100000   2.9599200
pair_coeff 148 148   0.2500000   3.5635900
pair_coeff 149 149   0.0157000   1.0690800
pair_coeff 150 150   0.0516624   1.0161201
pair_coeff 151 151   0.0504902   2.8834928
pair_coeff 152 152   0.0860000   3.3996700
pair_coeff 153 153   0.0451671   4.0142216
pair_coeff 154 154   0.0310088   6.7910445
pair_coeff 155 155   0.0380998   5.2544735
pair_coeff 156 156   0.0860000   3.3996700
pair_coeff 157 157   0.0470480   4.0737466
pair_coeff 158 158   0.0347336   2.5844492
pair_coeff 159 159   0.0331265   3.8787572
pair_coeff 160 160   0.0367451   2.6435015
pair_coeff 161 161   0.2100000   2.9599200
pair_coeff 162 162   0.0284798   2.8893208
pair_coeff 163 163   0.0341308   3.4972606
pair_coeff 164 164   0.0860000   3.3996700
pair_coeff 165 165   0.0572667   3.2871351
pair_coeff 166 166   0.0516624   1.0086625
pair_coeff 167 167   0.0322316   3.3886021
pair_coeff 168 168   0.0860000   3.3996700
pair_coeff 169 169   0.0574195   2.6621420
pair_coeff 170 170   0.0612278   3.6446612
pair_coeff 171 171   0.0404194   4.8883491
pair_coeff 172 172   0.0367451   2.6726392
pair_coeff 173 173   0.0424691   3.7577014
pair_coeff 174 174   0.0347336   2.8739288
pair_coeff 175 175   0.0414437   3.1318126
pair_coeff 176 176   0.0612278   4.1960299
pair_coeff 177 177   0.0367060   3.1741035
pair_coeff 178 178   0.0371534   3.8324013
pair_coeff 179 179   0.0610875   4.5487295
pair_coeff 180 180   0.0409998   3.6220363
pair_coeff 181 181   0.0476822   3.8968329
pair_coeff 182 182   0.0459766   5.1716949
pair_coeff 183 183   0.0537718   3.0970691
pair_coeff 184 184   0.0422370   4.5962253
pair_coeff 185 185   0.0366297   5.6388378
pair_coeff 186 186   0.0555148   3.4149765
pair_coeff 187 187   0.0833233   2.4073274
pair_coeff 188 188   0.0398143   2.6260427
pair_coeff 189 189   0.0860000   3.3996700
pair_coeff 190 190   0.0574195   1.8987628
pair_coeff 191 191   0.0347336   2.4962728
pair_coeff 192 192   0.0372065   3.3181476
pair_coeff 193 193   0.0860000   3.3996700
pair_coeff 194 194   0.2100000   2.9599200
pair_coeff 195 195   0.0516624   3.1141853
pair_coeff 196 196   0.0318045   3.7332360
pair_coeff 197 197   0.0860000   4.8884047
pair_coeff 198 198   0.0647048   4.0483961
pair_coeff 199 199   0.0516624   1.0094058
pair_coeff 200 200   0.0423895   3.4045982
pair_coeff 201 201   0.1453412   3.3508739
pair_coeff 202 202   0.0574195   3.7622998
pair_coeff 203 203   0.0478550   4.3565048
pair_coeff 204 204   0.0440449   4.0202919
pair_coeff 205 205   0.0459143   4.5321124
pair_coeff 206 206   0.0411177   4.3845559
pair_coeff 207 207   0.0387165   4.1818938
pair_coeff 208 208   0.0571791   4.4471694
pair_coeff 209 209   0.0461023   3.7391276
pair_coeff 210 210   0.0411177   4.5587390
pair_coeff 211 211   0.0611037   4.9243610
pair_coeff 212 212   0.0465200   5.6526180
pair_coeff 213 213   0.0399775   4.7243998
pair_coeff 214 214   0.0501424   3.9245356
pair_coeff 215 215   0.0395682   5.5334154
pair_coeff 216 216   0.0527416   4.6711744
pair_coeff 217 217   0.0571791   4.4698242
pair_coeff 218 218   0.0397884   3.6886276
pair_coeff 219 219   0.0596751   3.4428500
pair_coeff 220 220   0.0522705   3.2173048
pair_coeff 221 221   0.0367451   2.7718766
pair_coeff 222 222   0.0372683   3.6764476
pair_coeff 223 223   0.0516624   1.0108412
pair_coeff 224 224   0.0522705   3.0392670
pair_coeff 225 225   0.0860000   3.3996700
pair_coeff 226 226   0.2100000   2.9599200
pair_coeff 227 227   0.0516624   1.0069260
pair_coeff 228 228   0.0362609   4.8199100
pair_coeff 229 229   0.0860000   3.3996700
pair_coeff 230 230   0.0372683   3.2094859
pair_coeff 231 231   0.0516624   1.0082658
pair_coeff 232 232   0.0402606   3.8900866
pair_coeff 233 233   0.0860000   3.3996700
pair_coeff 234 234   0.0338591   3.8119060
pair_coeff 235 235   0.0683885   5.1487226
pair_coeff 236 236   0.0436309   3.8212915
pair_coeff 237 237   0.0276757   6.3459383
pair_coeff 238 238   0.2100000   2.9599200
pair_coeff 239 239   0.0516624   5.0086700
pair_coeff 240 240   0.0603370   3.1978577
pair_coeff 241 241   0.0860000   3.3996700
pair_coeff 242 242   0.0574195   3.2299071
pair_coeff 243 243   0.0516624   1.0191173
pair_coeff 244 244   0.0386399   3.9842226
pair_coeff 245 245   0.0860000   3.3996700
pair_coeff 246 246   0.2100000   2.9599200
pair_coeff 247 247   0.0860000   3.3996700
pair_coeff 248 248   0.1700000   3.2500000
pair_coeff 249 249   0.0860000   3.3996700
pair_coeff 250 250   0.0150000   2.4214600
pair_coeff 251 251   0.1700000   3.2500000
pair_coeff 252 252   0.0860000   3.3996700
pair_coeff 253 253   0.0150000   2.5105500
pair_coeff 254 254   0.1520999   3.1506100
pair_coeff 255 255   0.0000000   0.0000000
pair_coeff 256 256   0.0027700   3.3284000

pair_modify      mix arithmetic

# In case you use a restart, you need to copy all bonds and angles coefficient from .lmp file
# Please recall that before each row you need to write the string bond_coeff, angle_coeff
# and dihedral_coeff according with the case we are considering: Example.
# bond_coeff 1 harmonic  5.97514340e+01    3.95488306e+00    and so on

group            water type 254 255

group            AA    type 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 148 149 247 248 249 250 251 252 253

group            CG    type 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246

neighbor         1.0 bin
neigh_modify     every 1 delay 10 check yes

thermo_style     custom step temp press density vol ke ebond eangle evdwl ecoul etotal

thermo_modify    flush yes
thermo           ${Nf}

dump             trj all custom ${Ndump} mult-res.lammpstrj id type x y z
dump_modify      trj sort id

minimize         1.0e-4 1.0e-6 100 1000

fix 1            water shake 0.0001 20 0 t 254 255 b 3764 a 4078
fix 2            all npt temp ${Text} ${Text} 100.0 iso ${Pext} ${Pext} 1000.0

#fix 3           all nve
#fix 4           all langevin ${Text} ${Text} 100 9892571

restart          ${Nrestart} restart.${root}

timestep         1.0
run              ${Nrun}